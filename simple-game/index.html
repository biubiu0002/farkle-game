<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <title>Farkle 骰子游戏 v6.0</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <!-- 得分表格 -->
    <div class="scores-table">
      <table>
        <thead>
          <tr>
            <th id="player0Header" class="active">
              <span class="label">玩家1</span>
            </th>
            <th id="player1Header">
              <span class="label">玩家2</span>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td id="player0LastScoreCell" class="active">
              <span class="label">上轮</span><span class="score-value" id="player0LastScore">0</span>
            </td>
            <td id="player1LastScoreCell">
              <span class="label">上轮</span><span class="score-value" id="player1LastScore">0</span>
            </td>
          </tr>
          <tr>
            <td id="player0TotalScoreCell" class="active">
              <span class="label">总分</span><span class="total-score" id="player0TotalScore">0</span>
            </td>
            <td id="player1TotalScoreCell">
              <span class="label">总分</span><span class="total-score" id="player1TotalScore">0</span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- 消息 -->
    <div class="message" id="message">点击"开始游戏"</div>

    <!-- 骰子区域 -->
    <div class="dice-area" id="diceArea">
      <div class="dice-section held" id="heldSection">
        <span class="section-label">已保留</span>
        <div class="dice-row" id="heldDice"></div>
      </div>
      <div class="dice-section" id="remainingSection">
        <span class="section-label">
          请选择（至少选1个）
          <span class="selected-preview" id="selectedScorePreview" style="display: none;">
            | 选中得分：<span id="selectedScoreValue">0</span>
          </span>
        </span>
        <div class="dice-row" id="remainingDice"></div>
      </div>
    </div>

    <!-- 控制按钮 -->
    <div class="controls">
      <button class="btn btn-primary" id="btnStart">开始游戏</button>
      <button class="btn btn-info" id="btnRollAgain" style="display: none;">继续摇</button>
      <button class="btn btn-success" id="btnEndTurn" style="display: none;">结束回合</button>
      <button class="btn btn-warning" id="btnNext" style="display: none;">下一位</button>
      <button class="btn btn-danger" id="btnNewGame" style="display: none;">新游戏</button>
      <button class="btn btn-secondary" id="btnMute">🔊</button>
      <button class="btn btn-secondary" id="btnRules">规则</button>
    </div>
  </div>

  <!-- 规则弹窗 -->
  <div class="modal" id="rulesModal">
    <div class="modal-content">
      <div class="modal-title">游戏规则</div>
      <div class="rules-content">
        <div class="rule-text">目标：先达到10,000分</div>
        <div class="rule-text">每次摇骰子后，必须至少选择1个可计分的骰子</div>
        <div class="rule-text">选择骰子后有两个选项：</div>
        <div class="rule-sub">1. 继续摇：对剩余骰子重摇，如果Farkle则本轮分数丢失</div>
        <div class="rule-sub">2. 结束回合：存分到总分，轮到下一位</div>
        <div class="rule-text">Hot Dice：所有骰子都能计分时，可以重摇6个新骰子</div>
        <div class="rule-text">计分：</div>
        <div class="rule-sub">1 = 100分, 5 = 50分</div>
        <div class="rule-sub">三个相同：1=1000, 其他=点数×100</div>
        <div class="rule-sub">四/五/六个相同 = 翻倍</div>
        <div class="rule-sub">小顺子(1-5) = 500, 小顺子(2-6) = 600, 大顺子(1-6) = 1500</div>
      </div>
      <button class="btn btn-primary" onclick="document.getElementById('rulesModal').classList.remove('show')">关闭</button>
    </div>
  </div>

  <!-- 模块加载（按依赖顺序） -->
  <script src="utils/scorer.js"></script>
  <script src="utils/gameLogic.js"></script>
  <script src="utils/ui.js"></script>
  <script src="utils/sound-manager.js"></script>
  <script src="utils/bgm-manager.js"></script>
  <script src="utils/volume-panel.js"></script>
  <script src="game.js"></script>
</body>
</html>
